This is the SUPER performance version of This kata.

You task is exactly the same as that kata. But this time, you should output result % 998244353, or otherwise the result would be too large.

Data range
sometimes
  n <= 80000
  m <= 100000
while sometimes
  n <= 3000
  m <= 2^200
There are 150 random tests. You will need more than just a naive linear algorithm for this task :D

5976c5a5cd933a7bbd000029
